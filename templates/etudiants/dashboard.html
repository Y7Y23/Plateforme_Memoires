{% extends "base_etudiant.html" %}
{% block content %}

<h3 class="mb-4">Dashboard — {{ annee_libelle }}</h3>

<div class="row g-3 mb-4">
  <div class="col-md-3">
    <div class="card text-center">
      <div class="card-body">
        <h5>{{ stats.total }}</h5><small>Total mémoires</small>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-warning text-center">
      <div class="card-body">
        <h5>{{ stats.attente }}</h5><small>En attente</small>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-success text-center">
      <div class="card-body">
        <h5>{{ stats.valides }}</h5><small>Validés</small>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-danger text-center">
      <div class="card-body">
        <h5>{{ stats.refuses }}</h5><small>Refusés</small>
      </div>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <strong>Ma soutenance</strong>
    <div class="d-flex gap-2">
      <a href="{% url 'etudiant:soutenance_list' %}" class="btn btn-sm btn-outline-secondary">
        Voir toutes
      </a>
      {% if soutenance %}
        <a href="{% url 'etudiant:soutenance_detail' soutenance.id_soutenance %}"
           class="btn btn-sm btn-outline-primary">
          Détails
        </a>
      {% endif %}
    </div>
  </div>

  <div class="card-body">
    {% if soutenance %}
      <p class="mb-1"><strong>Mémoire :</strong> {{ soutenance.titre }}</p>
      <p class="mb-1"><strong>Date :</strong> {{ soutenance.date_ }} {{ soutenance.heure }}</p>
      <p class="mb-1"><strong>Salle :</strong> {{ soutenance.nom_salle }}</p>
      <p class="mb-2"><strong>Jury :</strong> {{ soutenance.nom_jury }}</p>

      <span class="badge
        {% if soutenance.statut == 'EFFECTUEE' %}bg-success
        {% elif soutenance.statut == 'PLANIFIEE' %}bg-warning text-dark
        {% else %}bg-secondary{% endif %}">
        {{ soutenance.statut }}
      </span>
    {% else %}
      <div class="text-muted">
        Aucune soutenance planifiée/associée à votre mémoire pour l’année {{ annee_libelle }}.
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}
