{% extends "base_etudiant.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h3 class="mb-0">Mes soutenances</h3>
    <div class="text-muted">Année : {{ annee_libelle }}</div>
  </div>
</div>

<form method="get" class="card mb-3">
  <div class="card-body">
    <div class="row g-2">
      <div class="col-md-6">
        <input class="form-control" name="q" value="{{ q }}" placeholder="Rechercher (titre, jury, salle...)">
      </div>
      <div class="col-md-3">
        <select class="form-select" name="statut">
          <option value="">— Statut —</option>
          {% for s in STATUTS %}
            <option value="{{ s }}" {% if statut == s %}selected{% endif %}>{{ s }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-3 d-flex gap-2">
        <button class="btn btn-primary w-100">Filtrer</button>
        <a class="btn btn-outline-secondary w-100" href="{% url 'etudiant:soutenance_list' %}">Reset</a>
      </div>
    </div>
  </div>
</form>

<div class="card">
  <div class="card-body">
    {% if rows %}
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th>Date</th>
              <th>Statut</th>
              <th>Mémoire</th>
              <th>Salle</th>
              <th>Jury</th>
              <th class="text-end">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for r in rows %}
              <tr>
                <td>
                  <div class="fw-semibold">{{ r.date_ }} {{ r.heure }}</div>
                  <div class="text-muted small">Soutenance #{{ r.id_soutenance }}</div>
                </td>
                <td>
                  <span class="badge
                    {% if r.statut == 'EFFECTUEE' %}bg-success
                    {% elif r.statut == 'PLANIFIEE' %}bg-warning text-dark
                    {% else %}bg-secondary{% endif %}">
                    {{ r.statut }}
                  </span>
                </td>
                <td>
                  <div class="fw-semibold">{{ r.titre }}</div>
                  <div class="text-muted small">{{ r.type }} · Mémoire #{{ r.id_memoire }}</div>
                </td>
                <td>{{ r.nom_salle }}</td>
                <td>{{ r.nom_jury }}</td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-primary"
                     href="{% url 'etudiant:soutenance_detail' r.id_soutenance %}">
                    Détails
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">Aucune soutenance trouvée.</div>
    {% endif %}
  </div>
</div>

{% endblock %}
